<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIKIDS Attendance System v4.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kantumruy+Pro:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kantumruy Pro', sans-serif; }
        @media print { .no-print { display: none; } }
        .active-class { background-color: #dbeafe; border-left: 4px solid #1e40af; color: #1e40af; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <header class="bg-blue-900 text-white p-4 no-print shadow-md">
        <div class="max-w-7xl mx-auto flex justify-between items-center px-4">
            <div class="flex items-center gap-4">
                <div class="bg-white p-2 rounded-lg">
                    <span class="text-blue-900 font-bold text-xl uppercase">Mikids</span>
                </div>
                <div>
                    <h1 class="text-lg font-bold italic">áŸá¶á›á¶á¢á“áŸ’áášá‡á¶áá·á˜áŸ‰á¶á™áƒá¸áŠ</h1>
                    <p class="text-xs opacity-80 uppercase tracking-widest text-[9px]">Attendance System</p>
                </div>
            </div>
            
            <div class="flex items-center gap-2 bg-blue-800 p-2 rounded-xl border border-blue-700">
                <select id="select-month" onchange="loadClass(selectedIndex)" class="bg-transparent text-white text-sm font-bold outline-none cursor-pointer">
                    <option value="á˜á€ášá¶" class="text-black">á˜á€ášá¶</option>
                    <option value="á€á»á˜áŸ’á—áŸˆ" class="text-black">á€á»á˜áŸ’á—áŸˆ</option>
                    <option value="á˜á¸á“á¶" class="text-black">á˜á¸á“á¶</option>
                    <option value="á˜áŸáŸá¶" class="text-black">á˜áŸáŸá¶</option>
                    <option value="á§áŸá—á¶" class="text-black">á§áŸá—á¶</option>
                    <option value="á˜á·áá»á“á¶" class="text-black">á˜á·áá»á“á¶</option>
                    <option value="á€á€áŸ’á€áŠá¶" class="text-black">á€á€áŸ’á€áŠá¶</option>
                    <option value="áŸá¸á á¶" class="text-black">áŸá¸á á¶</option>
                    <option value="á€á‰áŸ’á‰á¶" class="text-black">á€á‰áŸ’á‰á¶</option>
                    <option value="áá»á›á¶" class="text-black">áá»á›á¶</option>
                    <option value="áœá·á…áŸ’á†á·á€á¶" class="text-black">áœá·á…áŸ’á†á·á€á¶</option>
                    <option value="á’áŸ’á“á¼" class="text-black">á’áŸ’á“á¼</option>
                </select>
                <select id="select-year" onchange="loadClass(selectedIndex)" class="bg-transparent text-white text-sm font-bold outline-none cursor-pointer">
                    <option value="áŸ¢áŸ áŸ¢áŸ¥" class="text-black">áŸ¢áŸ áŸ¢áŸ¥</option>
                    <option value="áŸ¢áŸ áŸ¢áŸ¦" class="text-black" selected>áŸ¢áŸ áŸ¢áŸ¦</option>
                    <option value="áŸ¢áŸ áŸ¢áŸ§" class="text-black">áŸ¢áŸ áŸ¢áŸ§</option>
                    <option value="áŸ¢áŸ áŸ¢áŸ¨" class="text-black">áŸ¢áŸ áŸ¢áŸ¨</option>
                    <option value="áŸ¢áŸ áŸ¢áŸ©" class="text-black">áŸ¢áŸ áŸ¢áŸ©</option>
                    <option value="áŸ¢áŸ áŸ£áŸ " class="text-black">áŸ¢áŸ áŸ£áŸ </option>
                </select>
            </div>
        </div>
    </header>

    <div class="flex h-[calc(100vh-85px)]">
        <aside class="w-80 bg-white border-r overflow-y-auto p-4 no-print shadow-sm">
            <div class="mb-6 p-3 bg-blue-50 rounded-xl border border-blue-100">
                <label class="block text-[10px] font-bold text-blue-800 uppercase mb-2 italic">Telegram Config (Auto-Save)</label>
                <input id="tg-token" type="password" value="8501623225:AAGu-F_GHSQ-dLBrEME7eidOpW2yDf3qvXw" class="w-full text-[10px] p-2 border rounded mb-2 outline-none" placeholder="Bot Token">
                <input id="tg-chatid" type="text" value="-5090259958" class="w-full text-[10px] p-2 border rounded outline-none" placeholder="Chat ID">
            </div>

            <h3 class="text-gray-400 font-bold mb-3 px-2 text-[10px] uppercase tracking-widest">Class list</h3>
            <div id="class-menu" class="space-y-1 pb-10"></div>
        </aside>

        <main class="flex-1 overflow-auto p-8">
            <div class="max-w-5xl mx-auto">
                <div class="flex justify-between items-center mb-8 no-print">
                    <div>
                        <h2 id="current-class-title" class="text-3xl font-bold text-gray-800 italic uppercase">...</h2>
                        <p id="attendance-period" class="text-blue-600 font-medium mt-1 font-mono"></p>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="saveToBrowser()" class="bg-amber-500 text-white px-5 py-2.5 rounded-xl shadow-lg hover:bg-amber-600 font-bold transition flex items-center gap-2">
                            <span>ğŸ’¾</span> ášá€áŸ’áŸá¶á‘á»á€ (Save)
                        </button>
                        <button onclick="sendToTelegram()" class="bg-blue-600 text-white px-5 py-2.5 rounded-xl shadow-lg hover:bg-blue-700 font-bold transition flex items-center gap-2">
                            <span>âœˆï¸</span> á•áŸ’á‰á¾á‘áŸ… Telegram
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="bg-gray-50 border-b border-gray-100 uppercase text-[11px] tracking-wider text-gray-400">
                                <th class="p-4 w-16 text-center">á›.áš</th>
                                <th class="p-4 w-28">á¢ááŸ’áá›áŸá</th>
                                <th class="p-4">á‚áŸ„ááŸ’áá“á¶á˜ & á“á¶á˜</th>
                                <th class="p-4 w-20 text-center">á—áŸá‘</th>
                                <th class="p-4 text-center font-bold text-blue-900 bg-blue-50/50">áŸáŸ’áá¶á“á—á¶á–áœááŸ’áá˜á¶á“</th>
                            </tr>
                        </thead>
                        <tbody id="student-rows" class="divide-y divide-gray-50"></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        const schoolData = [
            { className: "ááŸ’á“á¶á€áŸ‹á˜ááŸ’ááŸá™áŸ’á™á‘á¶á”", students: [{id:"147", n:"áŸá»á—á€áŸ’áš áœá¸ášá”á»ááŸ’áš", g:"á”"},{id:"166", n:"á›á¸áá¶ ášáŸááŸ’á“á á»á„áŸáŸá€áŸ’á€á·á¢á’á·á—á¼", g:"á”"},{id:"160", n:"áá¼ áŸá·á‘áŸ’á’á¸á™á¼áá¶", g:"áŸ"},{id:"175", n:"á áŸá„ á‡áŸášá˜áŸ‰á¸á„", g:"áŸ"},{id:"---", n:"áœáŸ‰áŸá á“á¸ášá¸áá¶", g:"áŸ"}]},
            { className: "á˜ááŸ’ááŸá™áŸ’á™á˜á’áŸ’á™á˜", students: [{id:"64", n:"áƒá»á“ á‘áŸá–á„áŸ’áŸ", g:"á”"},{id:"121", n:"á“á¿á“ áœáŒáŸ’áá“á¶", g:"á”"},{id:"128", n:"á–á·áŸá·á‘áŸ’á¢ á…áŸá“áŸ’á‘áœáŒáŸ’áƒ", g:"á”"},{id:"141", n:"á áŸá„ áŸá¶á‡á¸á„", g:"áŸ"},{id:"132", n:"áŸá»á”á‰áŸ’á‰á¶ á˜á»á“á·ášá¶á‡", g:"á”"},{id:"67", n:"áˆá¿á“ á”áŸŠá»á“á’á¿á“á–á»á‘áŸ’á’á·", g:"á”"},{id:"173", n:"áŸá¶á“áŸ’á á›á¸á”áŸ‰áŸá„", g:"á”"},{id:"163", n:"á¢áŸá„ á›á¸á†áŸá„", g:"á”"},{id:"179", n:"á…á“áŸ’áá¶ áœáŒáŸ’áá“á¶", g:"á”"},{id:"162", n:"á™áŸ‰á¶á“áŸ‹ áŸá»áá¡áŸá„", g:"á”"}]},
            { className: "á˜ááŸ’ááŸá™áŸ’á™á˜á’áŸ’á™á˜ (áŸ¡)", students: [{id:"139", n:"á áŸŠáºá˜ á˜áŸ‰á¸á¢áŸŠá·", g:"á”"},{id:"146", n:"á›á“ áœáŸáŸáŸ’áŸá—á¼", g:"á”"},{id:"102", n:"áŸáŸ†áá¶á„ áœá¸ášáŸˆá”á»ááŸ’áš", g:"á”"},{id:"67", n:"áˆá¿á“ á”áŸŠá»á“á’á¿á“á–á»á‘áŸ’á’á·", g:"á”"},{id:"181", n:"áˆá“ á…áŸáŸáŸ’áŠá¶", g:"á”"},{id:"87", n:"á¢áŸŠá»áŸ† ášáá“á¶áŸá·á‘áŸ’á’á¸á€á¶áš", g:"áŸ"},{id:"113", n:"áŸáŸŠá¸á˜ áŸá·á‘áŸ’á’á¸á€á¶áš", g:"áŸ"},{id:"164", n:"á¢áŸŠá¼áŸá»áœááŸ’á áœáŸá á¶áŸ", g:"á”"},{id:"177", n:"áœá¶áŸá“á¶ á–áŸá‡áŸ’ášáŸá»á˜áŸ‰á¶á›á¸", g:"áŸ"},{id:"165", n:"á›á¹á˜ á›á¸á˜áŸ‰áŸá„á‚áŸá„áŸ’á‚", g:"á”"}]},
            { className: "á˜ááŸ’ááŸá™áŸ’á™ááŸ’á–áŸáŸ‹ (áŸ¡)", students: [{id:"29", n:"áá¶á“áŸ‹ á˜á»á“á¸áœá›áŸ’á›á—á¶", g:"áŸ"},{id:"101", n:"áˆá»áŸ† áœá¸ášáŸ‹áŸá·á‘áŸ’á’", g:"á”"},{id:"65", n:"á“á·á áŸá»á’á¶ášáŸ‰á¶", g:"á”"},{id:"78", n:"á“á¸ á›á¸á‡á¸á„", g:"áŸ"},{id:"117", n:"á áŸŠá»á“ ášá¶ááŸ’áá‡áŸááŸáŸ’áŠá¶", g:"á”"},{id:"47", n:"á”á»ááŸ’áá‡áŸ á‡áŸá“á“á¸", g:"áŸ"},{id:"14", n:"áƒá»á“ á‘áŸá–á¸", g:"áŸ"},{id:"62", n:"ášá·á‘áŸ’á’á¸ á–á·áŸáŸ’áŸá»ááŸá»á€áŸ’ášá¹á", g:"á”"},{id:"49", n:"á„á·á“ á‘áŸ€á“áœá·á“", g:"á”"},{id:"107", n:"áŸá»á—á€áŸ’ášáŸ áœášáŸˆáŸá·á‘áŸ’á’", g:"á”"},{id:"170", n:"á¢á»á›áœá¿á“ áŠá¶áœá¸á“", g:"áŸ"},{id:"137", n:"áŸá¿á“ á…á¶á“áŸ‹áŸá»á˜áŸá’á¶", g:"áŸ"},{id:"1", n:"á”áŸŠá»á“ášá¸á“ ááŸá˜ášá¶", g:"á”"}]},
            { className: "á˜ááŸ’ááŸá™áŸ’á™ááŸ’á–áŸáŸ‹ (áŸ¢)", students: [{id:"54", n:"á™á“áŸ‹ á›á¸á áŸá„", g:"á”"},{id:"75", n:"áœá·á“ á”á‰áŸ’á‰á¶áœáŸá“áŸ’á", g:"á”"},{id:"90", n:"áŸá¼ ášáŸáŸ’á˜á¸á–á“á·áá¶", g:"áŸ"},{id:"50", n:"áŸá¼á™ ášá€áŸ’áŸá¶", g:"á”"},{id:"0072", n:"á¢áŸŠá¼ áŸá»áá¢á¶á˜á¸", g:"áŸ"},{id:"137", n:"áŸá¿á“ á…á¶á“áŸ‹áŸá»á˜áŸá’á¶", g:"áŸ"},{id:"176", n:"á”áŸ‰á¹á˜ á˜áŸ‰á¸á‡á¼", g:"áŸ"},{id:"85", n:"áŸáŸášá¸ á…á“áŸ’á‘áœáŒáŸ’áá“á¶", g:"á”"},{id:"161", n:"á›á¸á˜ á áŸŠá¸á”áŸ‰", g:"á”"},{id:"55", n:"á¢áŸŠá¶ á‡á¸á„á áŸáš", g:"áŸ"},{id:"0079", n:"á˜á·ááŸ’á á˜áŸ‰áŸá„á áŸá„", g:"á”"},{id:"74", n:"á…á¶á“áŸ‹á“á¸ áŸáŸŠá¼áŸá¶á“áŸ‹áá¶", g:"áŸ"}]},
            { className: "ááŸ’á“á¶á€áŸ‹á‘á¸áŸ¡", students: [{id:"75", n:"á†á“ áœá·ášáŸˆáŸá·á‘áŸ’á’", g:"á”"},{id:"47", n:"á‡á¶á¡á·á… á€á¼á›á¸á“", g:"á”"},{id:"92", n:"áŸá»á”á‰áŸ’á‰á¶ áŸáŸ„á˜áŸ‰á¶", g:"áŸ"},{id:"83", n:"á—áºá“ áá·ášá¶á™á»", g:"á”"},{id:"69", n:"á›á¸ á†á¶á™áˆáŸá“", g:"á”"},{id:"77", n:"áœá»áŒáŸ’áá¸ áŠá¶áœá¸á€á¶", g:"áŸ"},{id:"93", n:"á¢áŸŠá¹á˜ ášáŸ„á…á“á¶", g:"áŸ"},{id:"72", n:"áœá„áŸ’áŸ áŠá¶ášáŸ‰á¶áœá¸á“", g:"á”"},{id:"95", n:"á…á¶áœ áœá·á“á á¶áœ", g:"á”"},{id:"80", n:"á„á½á“ á”á‰áŸ’á‰á¶á–á»á‘áŸ’á’á·áŸáŸá€áŸ’áá·", g:"á”"}]},
            { className: "ááŸ’á“á¶á€áŸ‹á‘á¸áŸ¡ (áŸ¡)", students: [{id:"88", n:"á…áŸ†ášá¾á“ á…á“áŸ’á‘á§ááŸ’áá˜", g:"á”"},{id:"91", n:"á”áŸŠá¼ áŸá¶á’á»á€á¶áš", g:"áŸ"},{id:"82", n:"áŸáŸá“ á™áŸ‰á¶áŸáŸ’á˜á¸á“áá¶", g:"áŸ"},{id:"85", n:"áŠá“ áŸá»á—áŸááŸ’áŒá˜áŸ‰á¼á“á¸á€á¶", g:"áŸ"},{id:"78", n:"áŸáŸŠáŸ’ášá¶á„ áŸáŸ€áœá áŸ’áœá»á„", g:"áŸ"},{id:"73", n:"á áŸá„ á˜áŸ‰á¸á¢áŸŠá·", g:"áŸ"},{id:"74", n:"á¢á¿á“ á–áŸ…áœá›áŸá€áŸ’á", g:"áŸ"},{id:"70", n:"ášáŸááŸ’á“ ášáŸ‰á¶ááŸá”", g:"á”"}]},
            { className: "ááŸ’á“á¶á€áŸ‹á‘á¸áŸ¢", students: [{id:"21", n:"á…á“áŸ’áá¶ á›á¸áá¶", g:"áŸ"},{id:"20", n:"á–áŸ… áŸá»áá…á·á“", g:"á”"},{id:"17", n:"áá¶ášáŸ‰á¶ á áŸá„á›á¸", g:"á”"},{id:"23", n:"áŸá»á áŸá˜áŸ’á”ááŸ’áá·", g:"á”"},{id:"22", n:"áŸá»á áŠá¶á›á¸áŸ", g:"áŸ"},{id:"29", n:"áŸáŸ’ášáŸáŸ‹ ášá¸á áŸ’áŸá¶", g:"áŸ"},{id:"41", n:"á”áŸ‰á»á“ ášá¸á™áŸ‰á¶", g:"áŸ"}]},
            { className: "ááŸ’á“á¶á€áŸ‹á‘á¸áŸ¢ (áŸ¡)", students: [{id:"59", n:"á¢á»á„ á”á‰áŸ’á‰á¶ášáŸááŸ’á“", g:"á”"},{id:"31", n:"á˜á·ááŸ’á á˜áŸ‰áŸá„á á½áš", g:"á”"},{id:"14", n:"á™áŸáŸ‹ á“ášá·á“áŸ’á‘", g:"á”"},{id:"33", n:"áœá„áŸ‹ á–á»á‘áŸ’á’á·áá¶", g:"áŸ"},{id:"62", n:"áŸá¼á™ á”á‰áŸ’á‰á¶", g:"á”"},{id:"40", n:"áŸáŸá„ áŸá¶áá¶", g:"áŸ"},{id:"39", n:"á…á“áŸ’á‘ áŸá»á•á¶á™áŸ‰á¶á˜áŸáƒ", g:"á”"},{id:"30", n:"áŸáŸŠá“áœá¸ášáŸˆ á”á‰áŸ’á‰á¶á‘áŸá–á¸", g:"áŸ"},{id:"27", n:"á”áŸŠá¼ áá¶á˜áŸ‰á¶", g:"á”"},{id:"65", n:"á€áŸ‚áœ á˜á»á“áŸ’á“á¸á§ááŸ’áá˜", g:"á”"},{id:"56", n:"áœá“áŸ’ááœá·á“ áá¶áá¶", g:"áŸ"},{id:"36", n:"á á¶á“ áŸáŸŠá¸áœá áŸáš", g:"áŸ"}]},
            { className: "ááŸ’á“á¶á€áŸ‹á‘á¸áŸ£", students: [{id:"9", n:"á€áŸ‚áœ áœá¸á“áŸá»á§ááŸ’ááá¶ášá¶", g:"áŸ"},{id:"28", n:"áˆá»á“áá¶ ášáá“áŸˆáá»á“áŠá¼", g:"áŸ"},{id:"10", n:"á™áŸ‰á¶ á–áŸá‡áŸ’ášá˜áŸ‰á¼á“á¸á€á¶", g:"áŸ"},{id:"15", n:"á›á¸á˜ á–á»á‘áŸ’á’á·ášá¶á‡", g:"á”"},{id:"3", n:"á¡ áŸáŸŠá¸áœá áŸŠá½á™", g:"áŸ"},{id:"2", n:"á¡á¶á™ á˜á»á“á·á…á·á“áŸ’áŠá¶", g:"áŸ"},{id:"24", n:"á¢áŸ„á€ á“á·áŸá·áŸ’áŸá", g:"á”"},{id:"44", n:"á…áŸ†ášá¾á“ á˜áŸ‰á¶á“á¸áá¶", g:"áŸ"}]},
            { className: "ááŸ’á“á¶á€áŸ‹á‘á¸áŸ¤-áŸ¥", students: [{id:"1", n:"á¡á¶á™ á—á¶ášáŸ‰á¶áŠá¶áœá¸áŒ", g:"á”"},{id:"42", n:"áœá„áŸ’áŸ á˜á»á“á¸á€á‰áŸ’á…á“á¶", g:"áŸ"},{id:"43", n:"á–áŸ… áŸá»á“á¸áá¶", g:"áŸ"},{id:"4", n:"á¡ áŸá»áœááŸ’áá á¶á“áŸ‹áá¶", g:"áŸ"}]},
            { className: "Fount 1 (á–áŸ’ášá¹á€)", students: [{id:"---", n:"á†á¶á„ áŸáŸŠá¸á„á¢á¶á™", g:"áŸ"},{id:"---", n:"áŸáŸŠá¸á˜ áŸá·á‘áŸ’á’á·á€á¶", g:"áŸ"},{id:"82", n:"ášá»á“ ášáŸáŸ’á˜á¸", g:"á”"},{id:"149", n:"á’á¸áŸá»áœááŸ’á áŸá·á‘áŸ’á’á·á€á¶", g:"áŸ"},{id:"143", n:"á•á“ áŸá»áá áŸ€á„", g:"á”"},{id:"133", n:"áŸá»á‘áŸ’á’ á›á¸á“á”áŸ’ášá»áŸáŸá·á‘áŸ’á’", g:"á”"}]},
            { className: "Fount 1 (á›áŸ’á„á¶á…)", students: [{id:"---", n:"á¢áŸŠá»áŸ† ášáá“á¶áŸá·á‘áŸ’á’á·á€á¶ášáŸ’á™", g:"áŸ"},{id:"---", n:"á„á·á“ á‘áŸ€á“áœá·á“", g:"á”"},{id:"116", n:"á†á“ á˜áŸ‰áŸá„áŸáŸŠá¸á“", g:"á”"},{id:"58", n:"á„á½á“ á‚á¸á˜á á¶á”áŸ‹", g:"á”"},{id:"145", n:"á†á¶á™ á—á¸á„á¢áŸŠá¸á„", g:"áŸ"},{id:"125", n:"á”á‰áŸ’á‰á¶ á—áŸááŸ’ášá¶", g:"áŸ"},{id:"90", n:"á…áŸ†ášá¾á“ ášá¿á“ášá¹á‘áŸ’á’á·ášá¶á‡", g:"á”"}]},
            { className: "Fount 2", students: [{id:"86", n:"á’áŸá„ á˜áŸ‰áŸá„á›á¸", g:"á”"},{id:"---", n:"áŸáŸŠáŸ’ášá¶á„ áŸáŸ€áœá áŸ’áœá»á„", g:"áŸ"},{id:"---", n:"á áŸá„ á˜áŸ‰á¸á¢áŸŠá·", g:"áŸ"},{id:"---", n:"á¢á¿á“ á–áŸ…áœá›áŸá€áŸ’á", g:"áŸ"},{id:"---", n:"á á¶á“ áŸáŸŠá¸áœá áŸáš", g:"áŸ"},{id:"70", n:"ášáŸááŸ’á“ ášáŸ‰á¶ááŸá”", g:"á”"}]},
            { className: "Level 1", students: [{id:"---", n:"á¢áŸ„á€ á§ááŸ’áá˜", g:"á”"},{id:"---", n:"áá¶ášáŸ‰á¶ á áŸá„á¡á¶á™", g:"á”"},{id:"62", n:"áˆá¼á€ áˆá·á“á¡á»á„", g:"á”"},{id:"---", n:"á–áŸ… áŸá»á“á¸áá¶", g:"áŸ"}]},
            { className: "Nursery", students: [{id:"148", n:"á”áŸášáŸ‰áŸáŸ á˜áŸ‰áŸƒáƒá¾áŸ", g:"á”"},{id:"144", n:"á áŸá„ áŸá“áŸ’áá·á—á¶á–", g:"á”"},{id:"157", n:"áŠá½á„ áŸá»á˜áŸá’á¶", g:"á”"},{id:"183", n:"áá»á„ á áŸ’áœá»á„á˜áŸ‰áŸá„", g:"á”"}]},
            { className: "Level 2", students: [{id:"48", n:"áŸá»á—á€áŸ’áŠá· á‘á·ááŸ’ášáŠá¶áá¶", g:"áŸ"},{id:"63", n:"á“á¿á“ áœáŒáŸ’áá“áŸ‡", g:"á”"},{id:"49", n:"áŸá»á—á€áŸ’áŠá· ášáá“", g:"á”"},{id:"61", n:"á•á› áŸá»áœááŸ’á", g:"á”"}]}
        ];

        let selectedIndex = 0;

        function init() {
            const menu = document.getElementById('class-menu');
            schoolData.forEach((c, i) => {
                const btn = document.createElement('button');
                btn.id = `btn-class-${i}`;
                btn.className = "w-full text-left p-3.5 rounded-xl hover:bg-gray-100 transition text-sm font-bold text-gray-700 flex justify-between items-center px-4 border-b border-gray-50";
                btn.innerHTML = `<span>${c.className}</span> <span class="text-[10px] bg-gray-100 text-gray-400 px-2 py-0.5 rounded-full">${c.students.length}</span>`;
                btn.onclick = () => loadClass(i);
                menu.appendChild(btn);
            });
            loadClass(0);
        }

        function loadClass(i) {
            selectedIndex = i;
            const data = schoolData[i];
            const month = document.getElementById('select-month').value;
            const year = document.getElementById('select-year').value;

            document.querySelectorAll('#class-menu button').forEach(b => b.classList.remove('active-class', 'bg-blue-50'));
            document.getElementById(`btn-class-${i}`).classList.add('active-class', 'bg-blue-50');

            document.getElementById('current-class-title').innerText = "ááŸ’á“á¶á€áŸ‹ " + data.className;
            document.getElementById('attendance-period').innerText = `Period: ${month} ${year}`;
            
            const storageKey = `MIKIDS_${data.className}_${month}_${year}`;
            const savedData = JSON.parse(localStorage.getItem(storageKey)) || {};

            const tbody = document.getElementById('student-rows');
            tbody.innerHTML = '';

            data.students.forEach((s, idx) => {
                const status = savedData[s.n] || 'P';
                tbody.innerHTML += `
                    <tr>
                        <td class="p-4 text-center text-gray-300 font-mono text-xs">${idx + 1}</td>
                        <td class="p-4 font-bold text-blue-600 font-mono text-xs">${s.id}</td>
                        <td class="p-4 font-bold text-gray-800">${s.n}</td>
                        <td class="p-4 text-center text-gray-500">${s.g}</td>
                        <td class="p-4 bg-blue-50/30">
                            <div class="flex justify-center gap-6">
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs"><input type="radio" name="st-${idx}" value="P" ${status === 'P' ? 'checked' : ''} class="accent-green-600"> á˜á€(Come)</label>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-orange-500"><input type="radio" name="st-${idx}" value="L" ${status === 'L' ? 'checked' : ''} class="accent-orange-500"> á…áŸ’á”á¶á”áŸ‹(Permission)</label>
                                <label class="flex items-center gap-1.5 cursor-pointer text-xs text-red-600 font-bold"><input type="radio" name="st-${idx}" value="A" ${status === 'A' ? 'checked' : ''} class="accent-red-600"> áˆá”áŸ‹(Absent)</label>
                            </div>
                        </td>
                    </tr>`;
            });
        }

        function saveToBrowser() {
            const data = schoolData[selectedIndex];
            const month = document.getElementById('select-month').value;
            const year = document.getElementById('select-year').value;
            const storageKey = `MIKIDS_${data.className}_${month}_${year}`;

            let attendanceToSave = {};
            document.querySelectorAll('#student-rows tr').forEach((row, idx) => {
                const status = row.querySelector(`input[name="st-${idx}"]:checked`).value;
                attendanceToSave[data.students[idx].n] = status;
            });

            localStorage.setItem(storageKey, JSON.stringify(attendanceToSave));
            alert(`âœ… Save Attendance student ${data.className} Month ${month} Complete!`);
        }

        async function sendToTelegram() {
            const token = document.getElementById('tg-token').value.trim();
            const chatId = document.getElementById('tg-chatid').value.trim();
            const month = document.getElementById('select-month').value;
            const year = document.getElementById('select-year').value;
            const data = schoolData[selectedIndex];
            
            if (!token || token.includes("...")) {
                alert("âŒ áŸá¼á˜á”á‰áŸ’á…á¼á› Bot Token á–áŸá‰á›áŸá‰!"); return;
            }

            let absents = [];
            document.querySelectorAll('#student-rows tr').forEach((row, idx) => {
                if(row.querySelector(`input[name="st-${idx}"]:checked`).value === 'A') {
                    absents.push(data.students[idx].n);
                }
            });

            let msg = `ğŸ“¢ *REPORT: ABSENT STUDENTS*\nğŸ« Class: *${data.className}*\nğŸ“… Period: *${month} ${year}*\n`;
            msg += `--------------------------\n`;
            msg += absents.length > 0 ? `âŒ Absent (${absents.length}):\n` + absents.map((n, i) => `${i+1}. ${n}`).join('\n') : `âœ… Everyone is present today!`;

            try {
                const url = `https://api.telegram.org/bot${token}/sendMessage`;
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ chat_id: chatId, text: msg, parse_mode: 'Markdown' })
                });

                const resData = await response.json();
                if(resData.ok) alert("âœˆï¸ ášá”á¶á™á€á¶ášááŸááŸ’ášá¼áœá”á¶á“á•áŸ’á‰á¾á‘áŸ… Telegram ášá½á…ášá¶á›áŸ‹!");
                else alert("âŒ Telegram Error: " + resData.description);
            } catch(e) {
                alert("âŒ á€á¶ášá•áŸ’á‰á¾á”ášá¶á‡áŸá™! áŸá¼á˜á†áŸ‚á€á¢áŸŠá¸á“á’áºáá·á á“á·á„ Bot Token áŸ”");
            }
        }

        init();
    </script>
</body>
</html>
