<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIKIDS Attendance System</title>
    <style>
        /* --- CSS Layout --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Khmer OS Siemreap', sans-serif; }
        body { background: #f0f2f5; padding: 15px; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; height: 95vh; }
        .header { background: #4e73df; color: white; padding: 15px; text-align: center; border-radius: 12px 12px 0 0; }
        
        .main-content { display: flex; flex: 1; overflow: hidden; }
        
        /* Sidebar */
        .sidebar { width: 320px; background: #f8f9fc; padding: 20px; border-right: 1px solid #e3e6f0; overflow-y: auto; }
        .section-title { font-weight: bold; color: #4e73df; margin: 15px 0 5px 0; border-bottom: 2px solid #e3e6f0; }
        .date-input { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #d1d3e2; margin-bottom: 10px; }
        
        .class-list { display: flex; flex-direction: column; gap: 5px; }
        .class-item { padding: 10px; background: white; border: 1px solid #d1d3e2; border-radius: 5px; cursor: pointer; font-size: 14px; transition: 0.2s; }
        .class-item:hover { background: #eaecf4; }
        .class-item.active { background: #4e73df; color: white; border-color: #4e73df; }
        
        /* Content Area */
        .content-area { flex: 1; padding: 20px; display: flex; flex-direction: column; overflow: hidden; }
        
        /* Summary Grid */
        .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; }
        .summary-box { text-align: center; padding: 10px; background: #f8f9fc; border-radius: 8px; border: 1px solid #e3e6f0; }
        .count { font-size: 20px; font-weight: bold; }

        /* Title Area */
        .list-header { 
            background: #f8f9fc; 
            padding: 12px 15px; 
            border-radius: 8px; 
            margin-bottom: 10px;
            border: 1px solid #e3e6f0;
            font-weight: bold; 
            color: #5a5c69;
        }

        #studentContainer { flex: 1; overflow-y: auto; padding-right: 10px; }
        
        /* Student Card */
        .student-card { display: flex; align-items: center; padding: 10px; background: #fff; border: 1px solid #e3e6f0; border-radius: 8px; margin-bottom: 8px; }
        .student-info { flex: 1; margin-left: 15px; }
        .student-name { font-weight: bold; font-size: 15px; color: #2e59d9; }
        
        .attendance-btns { display: flex; gap: 8px; }
        .btn-att { width: 45px; height: 45px; border: 1px solid #d1d3e2; border-radius: 8px; cursor: pointer; font-weight: bold; background: #f8f9fc; font-size: 16px; transition: 0.2s; }
        
        /* Active States */
        .btn-att.present.active { background: #1cc88a !important; color: white; border-color: #1cc88a; }
        .btn-att.permission.active { background: #f6c23e !important; color: white; border-color: #f6c23e; }
        .btn-att.absent.active { background: #e74a3b !important; color: white; border-color: #e74a3b; }

        .btn-main { padding: 12px 18px; border: none; border-radius: 6px; color: white; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 14px; }
        .bottom-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .btn-telegram { background: #0088cc; }
        .btn-excel { background: #28a745; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>MIKIDS Student Attendance Management System</h2>
    </div>

    <div class="main-content">
        <div class="sidebar">
            <p class="section-title">Select DataMonth</p>
            <input type="date" id="attDate" class="date-input">
            
            <p class="section-title">List Class</p>
            <div id="classList" class="class-list"></div>
        </div>

        <div class="content-area">
            <h3 id="displayClass" style="margin-bottom: 15px; color: #4e73df;">Select Class</h3>
            
            <div class="summary-grid">
                <div class="summary-box"><div>present (‚úîÔ∏è)</div><div class="count" id="cP" style="color: #1cc88a;">0</div></div>
                <div class="summary-box"><div>permission (P)</div><div class="count" id="cL" style="color: #f6c23e;">0</div></div>
                <div class="summary-box"><div>absent (A)</div><div class="count" id="cA" style="color: #e74a3b;">0</div></div>
                <div class="summary-box"><div>Total</div><div class="count" id="cT">0</div></div>
            </div>

            <div class="list-header">Student List</div>

            <div id="studentContainer"></div>

            <div class="bottom-actions">
                <button class="btn-main btn-telegram" onclick="sendToTelegram()">üì§ Send To Telegram</button>
                <button class="btn-main btn-excel" onclick="exportToExcel()">üì• Save is Excel</button>
            </div>
        </div>
    </div>
</div>

<script>
    const studentData = {
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûò·ûè·üí·ûè·üÅ·ûô·üí·ûô·ûÄ·ûò·üí·ûö·û∑·ûè·ûò·ûí·üí·ûô·ûò(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '64', name: '·ûÉ·ûª·ûì ·ûë·üÅ·ûñ·ûÑ·üí·ûü', sex: 'M' }, { id: '121', name: '·ûì·ûø·ûì ·ûú·ûå·üí·ûç·ûì·û∂', sex: 'M' },
            { id: '128', name: '·ûñ·û∑·ûü·û∑·ûë·üí·û¢ ·ûÖ·üê·ûì·üí·ûë·ûú·ûå·üí·ûÉ', sex: 'M' }, { id: '141', name: '·û†·üÅ·ûÑ ·ûü·û∂·ûá·û∏·ûÑ', sex: 'F' },
            { id: '132', name: '·ûü·ûª ·ûî·ûâ·üí·ûâ·û∂ ·ûò·ûª·ûì·û∑·ûö·û∂·ûá', sex: 'M' }, { id: '67', name: '·ûà·ûø·ûì ·ûî·üä·ûª·ûì·ûí·ûø·ûì·ûñ·ûª·ûë·üí·ûí·û∑', sex: 'M' },
            { id: '173', name: '·ûü·û∂·ûì·üí·ûè ·ûõ·û∏·ûî·üâ·üÅ·ûÑ', sex: 'M' }, { id: '163', name: '·û¢·üÅ·ûÑ ·ûõ·û∏·ûÜ·üÅ·ûÑ', sex: 'M' },
            { id: '179', name: '·ûÖ·ûì·üí·ûê·û∂ ·ûú·ûå·üí·ûç·ûì·û∂', sex: 'M' }, { id: '162', name: '·ûô·üâ·û∂·ûì·üã ·ûü·ûª·ûÅ·û°·üÅ·ûÑ', sex: 'M' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûò·ûè·üí·ûè·üÅ·ûô·üí·ûô·ûÄ·ûò·üí·ûö·û∑·ûè·ûò·ûí·üí·ûô·ûò(·ûö·ûü·üÄ·ûõ)': [
            { id: '139', name: '·û†·üä·û∫·ûò ·ûò·üâ·û∏·û¢·üä·û∑', sex: 'M' }, { id: '146', name: '·ûõ·ûì ·ûú·üÅ·ûü·üí·ûü·ûó·ûº', sex: 'M' },
            { id: '102', name: '·ûü·üÜ·ûé·û∂·ûÑ ·ûú·û∏·ûö·üà·ûî·ûª·ûè·üí·ûö', sex: 'M' }, { id: '67', name: '·ûà·ûø·ûì ·ûî·üä·ûª·ûì·ûí·ûø·ûì·ûñ·ûª·ûë·üí·ûí·û∑', sex: 'M' },
            { id: '87', name: '·û¢·üä·ûª·üÜ ·ûö·ûè·ûì·û∂·ûü·û∑·ûë·üí·ûí·û∏·ûÄ·û∂·ûö', sex: 'F' },{ id: '113', name: '·ûü·üä·û∏·ûò ·ûü·û∑·ûë·üí·ûí·û∏·ûÄ·û∂·ûö', sex: 'F' },
            { id: '164', name: '·û¢·üä·ûº·ûü·ûª·ûú·ûé·üí·ûé ·ûú·üÅ·û†·û∂·üç', sex: 'M' }, { id: '177', name: '·ûè·û∂·üÜ·ûÑ ·û†·üä·ûΩ·ûô·ûõ·û∏·ûì', sex: 'F' }, 
            { id: '165', name: '·ûõ·ûπ·ûò ·ûõ·û∏·ûò·üâ·üÅ·ûÑ·ûÇ·üê·ûÑ·üí·ûÇ', sex: 'M' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûò·ûè·üí·ûè·üÅ·ûô·üí·ûô·ûÄ·ûò·üí·ûö·û∑·ûè·ûÅ·üí·ûñ·ûü·üã(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '29', name: '·ûÅ·û∂·ûì·üã ·ûò·ûª·ûì·û∏·ûú·ûõ·üí·ûõ·ûó·û∂', sex: 'F' }, { id: '101', name: '·ûà·ûª·üÜ ·ûú·û∏·ûö·üã·ûü·û∑·ûë·üí·ûí', sex: 'M' },
            { id: '65', name: '·ûì·û∑·ûè ·ûü·ûª·ûí·û∂·ûö·üâ·û∂', sex: 'M' }, { id: '78', name: '·ûì·û∏ ·ûõ·û∏·ûá·û∏·ûÑ', sex: 'F' },
            { id: '117', name: '·û†·üä·ûª·ûì ·ûö·û∂·ûé·üí·ûé·ûá·üÅ·ûé·ûü·üí·ûä·û∂', sex: 'M' }, { id: '47', name: '·ûî·ûª·ûé·üí·ûé·ûá·üÅ ·ûá·üÅ·ûì·ûì·û∏', sex: 'F' },
            { id: '14', name: '·ûÉ·ûª·ûì ·ûë·üÅ·ûñ·û∏', sex: 'F' }, { id: '62', name: '·ûö·û∑·ûë·üí·ûí·û∏ ·ûñ·û∑·ûü·üí·ûü·ûª·ûè·ûü·ûª·ûÄ·üí·ûö·ûπ·ûè', sex: 'M' },
            { id: '49', name: '·ûÑ·û∑·ûì ·ûë·üÄ·ûì·ûú·û∑·ûì', sex: 'M' }, { id: '107', name: '·ûü·ûª·ûó·ûÄ·üí·ûö·üê ·ûú·ûö·üà·ûü·û∑·ûë·üí·ûí', sex: 'M' },
            { id: '170', name: '·û¢·ûª·ûõ·ûú·ûø·ûì ·ûä·û∂·ûú·û∏·ûì', sex: 'F' }, { id: '137', name: '·ûü·ûø·ûì ·ûÖ·û∂·ûì·üã·ûü·ûª·ûò·üÅ·ûí·û∂', sex: 'F' },
            { id: '1', name: '·ûî·üä·ûª·ûì·ûö·û∏·ûì ·ûÅ·üÅ·ûò·ûö·û∂', sex: 'M' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûò·ûè·üí·ûè·üÅ·ûô·üí·ûô·ûÄ·ûò·üí·ûö·û∑·ûè·ûÅ·üí·ûñ·ûü·üã(·ûö·ûü·üÄ·ûõ)': [
            { id: '54', name: '·ûô·ûì·üã ·ûõ·û∏·û†·üÅ·ûÑ', sex: 'M' }, { id: '75', name: '·ûú·û∑·ûì ·ûî·ûâ·üí·ûâ·û∂·ûú·üê·ûì·üí·ûè', sex: 'M' },
            { id: '90', name: '·ûü·ûº ·ûö·ûü·üí·ûò·û∏·ûñ·ûì·û∑·ûè·û∂', sex: 'F' }, { id: '50', name: '·ûü·ûº·ûô ·ûö·ûÄ·üí·ûü·û∂', sex: 'M' },
            { id: '0072', name: '·û¢·üä·ûº ·ûü·ûª·ûÅ·û¢·û∂·ûò·û∏', sex: 'F' }, { id: '137', name: '·ûü·ûø·ûì ·ûÖ·û∂·ûì·üã·ûü·ûª·ûò·üÅ·ûí·û∂', sex: 'F' },
            { id: '176', name: '·ûî·üâ·ûπ·ûò ·ûò·üâ·û∏·ûá·ûº', sex: 'F' }, { id: '85', name: '·ûü·üÅ·ûö·û∏ ·ûÖ·ûì·üí·ûë·ûú·ûå·üí·ûç·ûì·û∂', sex: 'M' },
            { id: '161', name: '·ûõ·û∏·ûò ·û†·üä·û∏·ûî·üâ', sex: 'M' }, { id: '55', name: '·û¢·üä·û∂ ·ûá·û∏·ûÑ·û†·üê·ûö', sex: 'F' },
            { id: '0079', name: '·ûò·û∑·ûè·üí·ûè ·ûò·üâ·üÅ·ûÑ·û†·üÅ·ûÑ', sex: 'M' }, { id: '74', name: '·ûÖ·û∂·ûì·üã·ûì·û∏‚Äã ·ûü·üä·ûº·ûü·û∂·ûì·üã·ûé·û∂', sex: 'F' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûë·û∏·ü°(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '75', name: '·ûÜ·ûì ·ûú·û∑·ûö·üà·ûü·û∑·ûë·üí·ûí', sex: 'M' }, { id: '47', name: '·ûá·û∂·û°·û∑·ûÖ ·ûÄ·ûº·ûõ·û∏·ûì', sex: 'M' },
            { id: '92', name: '·ûü·ûª·ûî·ûâ·üí·ûâ·û∂ ·ûü·üÑ·ûò·üâ·û∂', sex: 'F' }, { id: '83', name: '·ûó·û∫·ûì ·ûê·û∑·ûö·û∂·ûô·ûª', sex: 'M' },
            { id: '69', name: '·ûõ·û∏ ·ûÜ·û∂·ûô·ûà·üê·ûì', sex: 'M' }, { id: '77', name: '·ûú·ûª·ûå·üí·ûç·û∏ ·ûä·û∂·ûú·û∏·ûÄ·û∂', sex: 'F' },
            { id: '93', name: '·û¢·üä·ûπ·ûò ·ûö·üÑ·ûÖ·ûì·û∂', sex: 'F' }, { id: '72', name: '·ûú·ûÑ·üí·ûü ·ûä·û∂·ûö·üâ·û∂·ûú·û∏·ûì', sex: 'M' },
            { id: '95', name: '·ûÖ·û∂·ûú ·ûú·û∑·ûì·û†·û∂·ûú', sex: 'M' }, { id: '80', name: '·ûÑ·ûΩ·ûì ·ûî·ûâ·üí·ûâ·û∂·ûñ·ûª·ûë·üí·ûí·û∑·ûü·üê·ûÄ·üí·ûè·û∑', sex: 'M' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûë·û∏·ü°(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '88', name: '·ûÖ·üÜ·ûö·ûæ·ûì ·ûÖ·ûì·üí·ûë·ûß·ûè·üí·ûè·ûò', sex: 'M' }, { id: '91', name: '·ûî·üä·ûº ·ûü·û∂·ûí·ûª·ûÄ·û∂·ûö', sex: 'F' },
            { id: '82', name: '·ûü·üÅ·ûì ·ûô·üâ·û∂·ûü·üí·ûò·û∏·ûì·ûé·û∂', sex: 'F' }, { id: '85', name: '·ûä·ûì ·ûü·ûª·ûó·üê·ûé·üí·ûå·ûò·üâ·ûº·ûì·û∏·ûÄ·û∂', sex: 'F' },
            { id: '78', name: '·ûü·üä·üí·ûö·û∂·ûÑ ·ûü·üÄ·ûú·û†·üí·ûú·ûª·ûÑ', sex: 'F' }, { id: '73', name: '·û†·üÅ·ûÑ ·ûò·üâ·û∏·û¢·üä·û∑', sex: 'F' },
            { id: '74', name: '·û¢·ûø·ûì ·ûñ·üÖ·ûú·ûõ·üê·ûÄ·üí·ûÅ', sex: 'F' }, { id: '70', name: '·ûö·üê·ûè·üí·ûì ·ûö·üâ·û∂·ûê·üÅ·ûî', sex: 'M' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûë·û∏·ü¢(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '21', name: '·ûÖ·ûì·üí·ûê·û∂ ·ûõ·û∏·ûè·û∂', sex: 'F' }, { id: '20', name: '·ûñ·üÖ ·ûü·ûª·ûÅ·ûÖ·û∑·ûì', sex: 'M' },
            { id: '17', name: '·ûé·û∂·ûö·üâ·û∂ ·û†·üÅ·ûÑ·ûõ·û∏', sex: 'M' }, { id: '23', name: '·ûü·ûª·ûÅ ·ûü·ûò·üí·ûî·ûè·üí·ûè·û∑', sex: 'M' },
            { id: '22', name: '·ûü·ûª·ûÅ ·ûä·û∂·ûõ·û∏·ûü', sex: 'F' }, { id: '29', name: '·ûü·üí·ûö·ûü·üã ·ûö·û∏·û†·üí·ûü·û∂', sex: 'F' },
            { id: '41', name: '·ûî·üâ·ûª·ûì ·ûö·û∏·ûô·üâ·û∂', sex: 'F' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûë·û∏·ü¢(·ûö·ûü·üÄ·ûõ)': [
            { id: '59', name: '·û¢·ûª·ûÑ ·ûî·ûâ·üí·ûâ·û∂·ûö·üê·ûè·üí·ûì', sex: 'M' }, { id: '31', name: '·ûò·û∑·ûè·üí·ûè ·ûò·üâ·üÅ·ûÑ·û†·ûΩ·ûö', sex: 'M' },
            { id: '14', name: '·ûô·ûü·üã ·ûì·ûö·û∑·ûì·üí·ûë', sex: 'M' }, { id: '33', name: '·ûú·ûÑ·üã ·ûñ·ûª·ûë·üí·ûí·û∑·ûè·û∂', sex: 'F' },
            { id: '62', name: '·ûü·ûº·ûô ·ûî·ûâ·üí·ûâ·û∂', sex: 'M' }, { id: '40', name: '·ûü·üÅ·ûÑ ·ûü·û∂·ûé·û∂', sex: 'F' },
            { id: '39', name: '·ûÖ·ûì·üí·ûë ·ûü·ûª·ûï·û∂·ûô·üâ·û∂·ûò·üÅ·ûÉ', sex: 'M' }, { id: '30', name: '·ûü·üä·ûì·ûú·û∏·ûö·üà ·ûî·ûâ·üí·ûâ·û∂·ûë·üÅ·ûñ·û∏', sex: 'F' },
            { id: '27', name: '·ûî·üä·ûº ·ûè·û∂·ûò·üâ·û∂', sex: 'M' }, { id: '65', name: '·ûÄ·üÇ·ûú ·ûò·ûª·ûì·üí·ûì·û∏·ûß·ûè·üí·ûè·ûò', sex: 'M' },
            { id: '56', name: '·ûú·ûì·üí·ûè·ûú·û∑·ûì ·ûê·û∂·ûé·û∂', sex: 'F' }, { id: '36', name: '·û†·û∂·ûì ·ûü·üä·û∏·ûú·û†·üê·ûö', sex: 'F' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûë·û∏·ü£(·ûö·ûü·üÄ·ûõ)': [
            { id: '9', name: '·ûÄ·üÇ·ûú ·ûú·û∏·ûì·ûü·ûª·ûß·ûè·üí·ûè·ûè·û∂·ûö·û∂', sex: 'F' }, { id: '28', name: '·ûà·ûª·ûì·ûè·û∂ ·ûö·ûè·ûì·üà·ûÅ·ûª·ûì·ûä·ûº', sex: 'F' },
            { id: '10', name: '·ûô·üâ·û∂ ·ûñ·üÅ·ûá·üí·ûö·ûò·üâ·ûº·ûì·û∏·ûÄ·û∂', sex: 'F' }, { id: '15', name: '·ûõ·û∏·ûò ·ûñ·ûª·ûë·üí·ûí·û∑·ûö·û∂·ûá', sex: 'M' },
            { id: '3', name: '·û° ·ûü·üä·û∏·ûú·û†·üä·ûΩ·ûô', sex: 'F' }, { id: '2', name: '·û°·û∂·ûô ·ûò·ûª·ûì·û∑·ûÖ·û∑·ûì·üí·ûä·û∂', sex: 'F' },
            { id: '24', name: '·û¢·üÑ·ûÄ ·ûì·û∑·ûü·û∑·üí·ûü·ûè', sex: 'M' }, { id: '44', name: '·ûÖ·üÜ·ûö·ûæ·ûì ·ûò·üâ·û∂·ûì·û∏·ûè·û∂', sex: 'F' }
        ],
        '·ûê·üí·ûì·û∂·ûÄ·üã·ûë·û∏·ü§‚Äã ·ü•': [
            { id: '1', name: '·û°·û∂·ûô ·ûó·û∂·ûö·üâ·û∂·ûä·û∂·ûú·û∏·ûå', sex: 'M' }, { id: '42', name: '·ûú·ûÑ·üí·ûü ·ûò·ûª·ûì·û∏·ûÄ·ûâ·üí·ûÖ·ûì·û∂', sex: 'F' },
            { id: '43', name: '·ûñ·üÖ ·ûü·ûª·ûì·û∏·ûè·û∂', sex: 'F' }, { id: '4', name: '·û° ·ûü·ûª·ûú·ûé·üí·ûé·û†·û∂·ûì·üã·ûé·û∂', sex: 'F' }
        ],
        'Fount1 mooning': [
            { id: '82', name: '·ûö·ûª·ûì ·ûö·ûü·üí·ûò·û∏', sex: 'M' }, { id: '149', name: '·ûí·û∏ ·ûü·ûª·ûú·ûé·üí·ûé ·ûü·û∑·ûë·üí·ûí·û∑·ûÄ·û∂', sex: 'F' },
            { id: '143', name: '·ûï·ûì ·ûü·ûª·ûÅ·û†·üÄ·ûÑ', sex: 'M' }, { id: '133', name: '·ûü·ûª·ûë·üí·ûí ·ûõ·û∏·ûì·ûî·üí·ûö·ûª·ûü·ûü·û∑·ûë·üí·ûí', sex: 'M' },
            { id: '134', name: '·û¢·üä·û∂·ûî ·ûõ·û∏·ûô·û∏·ûÑ', sex: 'F' }, { id: '88', name: '·ûÖ·üÜ·ûö·ûæ·ûì ·ûÖ·ûì·üí·ûë·ûß·ûè·üí·ûè·ûò', sex: 'M' },
            { id: '127', name: '·û†·ûò ·ûÖ·û∂·ûì·üã·ûî·ûª·ûö·û∏·ûö·ûÄ·üí·ûü', sex: 'M' }, { id: '182', name: '·ûè·û∂·üÜ·ûÑ ·û†·üä·ûΩ·ûô·ûõ·û∏·ûì', sex: 'F' }
        ],
        'Fount1 Evening': [
            { id: '116', name: '·ûÜ·ûì ·ûò·üâ·üÅ·ûÑ·ûü·üä·û∏·ûì', sex: 'M' }, { id: '58', name: '·ûÑ·ûΩ·ûì ·ûÇ·û∏·ûò·û†·û∂·ûî·üã', sex: 'M' },
            { id: '145', name: '·ûÜ·û∂·ûô ·ûó·û∏·ûÑ·û¢·üä·û∏·ûÑ', sex: 'F' }, { id: '125', name: '·ûî·ûâ·üí·ûâ·û∂ ·ûó·üÅ·ûè·üí·ûö·û∂', sex: 'F' },
            { id: '90', name: '·ûÖ·üÜ·ûö·ûæ·ûì ·ûö·ûø·ûì·ûö·ûπ·ûë·üí·ûí·û∑·ûö·û∂·ûá', sex: 'M' }, { id: '159', name: '·ûê·ûì ·ûü·üä·û∏·û†·üí·ûÇ·üí·ûü·û∑·ûÖ', sex: 'F' }
        ],
        'Nursery(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '148', name: '·ûî·üÅ·ûö·üâ·üÅ·ûü ·ûò·üâ·üÉ·ûÉ·ûæ·ûü', sex: 'M' }, { id: '144', name: '·û†·üÅ·ûÑ ·ûü·ûì·üí·ûè·û∑·ûó·û∂·ûñ', sex: 'M' },
            { id: '157', name: '·ûä·ûΩ·ûÑ ·ûü·ûª·ûò·üÅ·ûí·û∂', sex: 'M' }, { id: '183', name: '·ûê·ûª·ûÑ ·û†·üí·ûú·ûª·ûÑ·ûò·üâ·üÅ·ûÑ', sex: 'M' },
            { id: '158', name: '·ûñ·ûì·üí·ûõ·ûÄ ·ûú·û∑·ûö·ûü·û∑·ûë·üí·ûí', sex: 'M' }, { id: '172', name: '·ûö·ûè·ûì·û∂ ·ûü·üÄ·ûú·ûõ·û∑', sex: 'F' },
            { id: '180', name: '·ûö·üâ·û∂·ûè·üã ·ûñ·üÅ·ûá·üí·ûö·ûò·ûö·ûÄ·ûè', sex: 'F' }, { id: '178', name: '·ûõ·û∏·ûú·ûë·üí·ûí·û∏ ·ûá·ûª·ûè·û∑·ûò·û∂', sex: 'F' },
            { id: '184', name: '·û†·ûº ·ûõ·û∏·ûó·û∏·ûÑ', sex: 'M' }, { id: '174', name: '·ûú·û∑·ûÖ·üí·ûÜ·û∑·ûÄ·û∂ ·ûò·ûª·ûì·üí·ûì·û∏·ûë·üÅ·ûñ·û∏', sex: 'F' },
            { id: '185', name: '·ûô·ûπ·ûò ·ûñ·ûª·ûë·üí·ûí·û∑·ûú·ûÑ·üí·ûü', sex: 'M' }, { id: '171', name: '·ûü·ûª·ûÑ ·ûü·û∑·ûö·û∏·ûî·ûª·ûè·üí·ûö', sex: 'M' }
            ],
         'Nursery(·ûö·ûü·üÄ·ûõ)': [
            { id: '148', name: '·ûî·üÅ·ûö·üâ·üÅ·ûü ·ûò·üâ·üÉ·ûÉ·ûæ·ûü', sex: 'M' },
            { id: '147', name: '·ûü·ûª·ûó·üê·ûÄ·üí·ûö ·ûú·û∏·ûö·ûî·ûª·ûè·üí·ûö', sex: 'M' }, { id: '150', name: '·ûú·üâ·üÅ·ûè ·ûì·û∏·ûö·û∏·ûè·û∂', sex: 'F' },
            { id: '166', name: '·ûõ·û∏·ûé·û∂ ·û†·ûª·ûÑ·ûü·üê·ûÄ·üí·ûÄ·û∑·û¢·ûí·û∑·ûó·ûº', sex: 'M' }
        ],
        'Fount2': [
            { id: '86', name: '·ûí·üÅ·ûÑ ·ûò·üâ·üÅ·ûÑ·ûõ·û∏', sex: 'M' }, { id: '00', name: '·ûü·üä·üí·ûö·û∂·ûÑ ·ûü·üÄ·ûú·û†·üí·ûú·ûª·ûÑ', sex: 'F' },
            { id: '00', name: '·û†·üÅ·ûÑ ·ûò·üâ·û∏·û¢·üä·û∑', sex: 'F' }, { id: '00', name: '·û¢·ûø·ûì ·ûñ·üÖ·ûú·ûõ·üê·ûÄ·üí·ûÅ', sex: 'F' },
            { id: '00', name: '·û†·û∂·ûì ·ûü·üä·û∏·ûú·û†·üê·ûö', sex: 'F' }, { id: '00', name: '·ûö·üê·ûè·üí·ûì ·ûü·ûª·ûú·ûé·üí·ûé·ûÖ·üê·ûì·üí·ûë·ûé·û∂·ûÄ·û∂', sex: 'M' },
            { id: '00', name: '·ûÖ·üÜ·ûö·ûæ·ûì ·ûò·üâ·û∂·ûì·û∏·ûè·û∂ ', sex: 'F' }, { id: '70', name: '·ûö·üê·ûè·üí·ûì ·ûö·üâ·û∂·ûê·üÅ·ûî', sex: 'M' }
        ],
        'Fount2(narein)': [
            { id: '68', name: '·ûü·ûª·ûÑ ·ûö·ûπ·ûë·üí·ûí·ûü·üê·ûÄ·üí·ûÄ', sex: 'M' }, { id: '00', name: '·ûñ·üÖ ·ûü·ûª·ûÅ·ûÖ·û∑·ûì', sex: 'M' },
            { id: '66', name: '·ûî·üä·ûª·ûì·û°·üÅ·ûÑ ·û¢·üä·üÉ·ûä·ûπ·ûÄ', sex: 'M' }, { id: '67', name: '·ûó·üÑ·ûÇ ·ûü·üí·ûñ·û∏·ûè·ûå·û∏', sex: 'M' },
            { id: '00', name: '·û¢·üä·ûπ·ûò ·ûö·üÑ·ûÖ·ûì·û∂', sex: 'F' }, { id: '00', name: '·ûÑ·ûΩ·ûì ·ûî·ûâ·üí·ûâ·û∂·ûñ·ûª·ûë·üí·ûí·û∑·ûü·üê·ûÄ·üí·ûè·û∑', sex: 'M' },
            { id: '00', name: '·ûá·û∂·û°·û∑·ûÖ ·ûÄ·ûº·ûõ·û∏·ûì', sex: 'M' }, { id: '00', name: '·ûé·û∂·ûö·üâ·û∂ ·û†·üÅ·ûÑ·ûõ·û∏', sex: 'M' },
            { id: '00', name: '·ûÜ·ûì ·ûú·û∑·ûö·üà·ûü·û∑·ûë·üí·ûí', sex: 'M' }, { id: '00', name: '·ûü·ûª·ûÅ ·ûü·ûò·üí·ûî·ûè·üí·ûè·û∑', sex: 'M' },
            { id: '00', name: '·ûü·ûª·ûÅ ·ûä·û∂·ûõ·û∏·ûü', sex: 'F' }, { id: '00', name: '·ûÖ·û∂·ûú ·ûú·û∑·ûì·û†·û∂·ûú', sex: 'M' },
            { id: '00', name: '·ûõ·û∏ ·ûÜ·û∂·ûô·ûà·üê·ûì·ûî', sex: 'M' }
        ],
        'Level1': [
            { id: '00', name: '·û¢·üÑ·ûÄ ·ûß·ûè·üí·ûè·ûò', sex: 'M' }, { id: '00', name: '·ûé·û∂·ûö·üâ·û∂ ·û†·üÅ·ûÑ·û°·û∂·ûô', sex: 'M' },
            { id: '62', name: '·ûà·ûº·ûÄ ·ûà·û∑·ûì·û°·ûª·ûÑ', sex: 'M' }, { id: '00', name: '·ûñ·üÖ ·ûü·ûª·ûì·û∏·ûè·û∂', sex: 'F' },
            { id: '00', name: '·ûÄ·üÇ·ûú ·ûú·û∏·ûì·ûü·ûª·ûß·ûè·üí·ûè·ûè·û∂·ûö·û∂', sex: 'F' }, { id: '00', name: '·ûà·ûª·ûì·ûè·û∂ ·ûö·ûè·ûì·üà·ûÅ·ûª·ûì·ûä·ûº', sex: 'F' },
            { id: '64', name: '·ûõ·û∂·ûÑ ·ûú·ûå·üí·ûÉ·ûì·ûí·ûì·ûª', sex: 'M' }, { id: '00', name: '·ûô·üâ·û∂ ·ûñ·üÅ·ûá·üí·ûö·ûò·üâ·ûº·ûì·û∏·ûÄ·û∂', sex: 'F' },
            { id: '00', name: '·ûõ·û∏·ûò ·ûñ·ûª·ûë·üí·ûí·û∑·ûö·û∂·ûá', sex: 'M' }, { id: '00', name: '·û° ·ûü·üä·û∏·ûú·û†·üä·ûΩ·ûô', sex: 'F' },
            { id: '00', name: '·û°·û∂·ûô ·ûò·ûª·ûì·û∑·ûÖ·û∑·ûì·üí·ûä·û∂', sex: 'F' }, { id: '00', name: '·û¢·üÑ·ûÄ ·ûì·û∑·ûü·û∑·üí·ûü·ûè', sex: 'M' },
            { id: '00', name: '·ûÖ·ûì·üí·ûë ·ûü·ûª·ûï·û∂·ûô·üâ·û∂·ûò·üÅ·ûÉ', sex: 'M' }, { id: '00', name: '·ûü·üä·ûì·ûú·û∏·ûö·üà ·ûî·ûâ·üí·ûâ·û∂·ûë·üÅ·ûñ·û∏', sex: 'F' }
        ],
        'Level2': [
            { id: '48', name: '·ûü·ûª·ûó·ûÄ·üí·ûä·û∑ ·ûë·û∑·ûè·üí·ûö·ûä·û∂·ûé·û∂', sex: 'F' }, { id: '63', name: '·ûì·ûø·ûì ·ûú·ûå·üí·ûç·ûì·üá', sex: 'M' },
            { id: '49', name: '·ûü·ûª·ûó·ûÄ·üí·ûä·û∑ ·ûö·ûè·ûì', sex: 'M' }, { id: '61', name: '·ûï·ûõ‚Äã ·ûü·ûª·ûú·ûé·üí·ûé', sex: 'M' },
            { id: '53', name: '·û†·ûª·ûÑ ·ûü·û∑·ûë·üí·ûí·û∑·ûé·û∂·ûõ·üã', sex: 'M' }, { id: '55', name: '·ûí·üÅ·ûÑ ·ûá·ûº·ûõ·û∏·ûâ', sex: 'F' },
            { id: '1', name: '·û°·û∂·ûô ·ûó·û∂·ûö·üâ·û∂·ûä·û∂·ûú·û∏·ûå', sex: 'M' }, { id: '4', name: '·û° ·ûü·ûª·ûú·ûé·üí·ûé·û†·û∂·ûì·üã·ûé·û∂', sex: 'F' }
        ],
        '·ûò·ûè·üí·ûä·üÅ·ûô·üí·ûô·ûÄ·ûò·üí·ûö·û∑·ûè·ûë·û∂·ûî(·ûñ·üí·ûö·ûπ·ûÄ)': [
            { id: '147', name: '·ûü·ûª·ûó·ûÄ·üí·ûö ·ûú·û∏·ûö·ûî·ûª·ûè·üí·ûö', sex: 'M' }, { id: '166', name: '·ûõ·û∏·ûé·û∂ ·ûö·üê·ûè·üí·ûì·û†·ûª·ûÑ·ûü·üê·ûÄ·üí·ûÄ·û∑·û¢·ûí·û∑·ûó·ûº', sex: 'M' },
            { id: '160', name: '·ûê·ûº ·ûü·û∑·ûë·üí·ûí·û∏·ûô·ûº·ûé·û∂', sex: 'F' }, { id: '175', name: '·ûü·ûª·ûÇ·ûì·üí·ûí ·ûî·ûâ·üí·ûâ·û∂·ûü·üê·ûÄ', sex: 'M' },
            { id: '000', name: '·ûü·ûª·û∏·ûò ·ûü·ûö·ûß·ûè·üí·ûè·ûò', sex: 'M' },{ id: '000' , name: '·ûì·û∑·ûè ·ûü·ûª·ûí·û∂·ûö·û∂·ûá',  sex:'M'},
            { id: '000', name: '·ûú·üâ·üÅ·ûè ·ûì·û∏·ûö·û∏·ûè·û∂', sex: 'F' }
        ],
        '·ûò·ûè·üí·ûä·üÅ·ûô·üí·ûô·ûÄ·ûò·üí·ûö·û∑·ûè·ûë·û∂·ûî(·ûö·ûü·üÄ·ûõ)':[
            { id: '175', name: '·û†·üÅ·ûÑ ·ûá·üê·ûö·ûò·ûª·û∏·ûÑ', sex: 'F' }, { id: '000', name: '·ûü·û∂·ûô ·ûü·ûª·ûÅ·û†·üÅ·ûÑ', sex: 'M' },
            { id: '181', name: '·ûà·ûì ·ûÖ·üÅ·ûü·üí·ûä·û∂', sex: 'M' }, { id: '000', name: '·ûõ·û∂·ûÑ ·ûõ·ûÄ·üí·ûü·ûª·û∑·ûÄ·ûâ·üí·ûÖ·ûì·û∂', sex: 'M' },
            { id: '177', name: '·ûú·û∂·ûü·ûì·û∂ ·ûñ·üÅ·ûá·üí·ûö·ûü·ûª·ûò·üâ·û∂·ûõ·û∏', sex: 'F' }
        ]
    };

    document.getElementById('attDate').valueAsDate = new Date();
    const classListDiv = document.getElementById('classList');
    
    Object.keys(studentData).forEach((className, index) => {
        const div = document.createElement('div');
        div.className = `class-item ${index === 0 ? 'active' : ''}`;
        div.innerText = className;
        div.onclick = () => selectClass(div, className);
        classListDiv.appendChild(div);
    });

    function selectClass(element, className) {
        document.querySelectorAll('.class-item').forEach(i => i.classList.remove('active'));
        element.classList.add('active');
        document.getElementById('displayClass').innerText = "ListName - " + className;
        renderStudents(className);
    }

    function renderStudents(className) {
        const container = document.getElementById('studentContainer');
        container.innerHTML = "";
        const students = studentData[className] || [];
        
        students.forEach(s => {
            const card = document.createElement('div');
            card.className = 'student-card';
            card.setAttribute('data-name', s.name);
            card.innerHTML = `
                <div style="font-weight:bold; color:#4e73df; width:40px;">${s.id}</div>
                <div class="student-info">
                    <div class="student-name">${s.name}</div>
                    <div style="font-size:12px; color:#858796;">Sex: ${s.sex === 'M' ? 'Male' : 'Female'}</div>
                </div>
                <div class="attendance-btns">
                    <button class="btn-att present" onclick="mark(this, '‚úîÔ∏è')">‚úîÔ∏è</button>
                    <button class="btn-att permission" onclick="mark(this, 'P')">P</button>
                    <button class="btn-att absent" onclick="mark(this, 'A')">A</button>
                </div>
            `;
            container.appendChild(card);
        });
        calculateSummary();
    }

    function mark(btn, type) {
        const parent = btn.parentElement;
        parent.querySelectorAll('.btn-att').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        calculateSummary();
    }

    function calculateSummary() {
        document.getElementById('cP').innerText = document.querySelectorAll('.btn-att.present.active').length;
        document.getElementById('cL').innerText = document.querySelectorAll('.btn-att.permission.active').length;
        document.getElementById('cA').innerText = document.querySelectorAll('.btn-att.absent.active').length;
        document.getElementById('cT').innerText = document.querySelectorAll('.student-card').length;
    }

    function exportToExcel() {
        const activeClass = document.querySelector('.class-item.active');
        if(!activeClass) return;
        const className = activeClass.innerText;
        let csv = "\uFEFFID,StudentName,Status\n";
        document.querySelectorAll('.student-card').forEach((card, i) => {
            let status = "-";
            if(card.querySelector('.btn-att.present').classList.contains('active')) status = "P";
            if(card.querySelector('.btn-att.permission').classList.contains('active')) status = "L";
            if(card.querySelector('.btn-att.absent').classList.contains('active')) status = "A";
            csv += `${i+1},${card.getAttribute('data-name')},${status}\n`;
        });
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `Attendance_${className}.csv`;
        link.click();
    }

    // --- ·ûî·üÜ·ûñ·üÅ·ûâ·ûñ·üê·ûè·üå·ûò·û∂·ûì Bot ·ûö·ûî·ûü·üã·û¢·üí·ûì·ûÄ·ûì·üÖ·ûë·û∏·ûì·üÅ·üá ---
const TELEGRAM_BOT_TOKEN = '8501623225:AAGu-F_GHSQ-dLBrEME7eidOpW2yDf3qvXw'; 
const TELEGRAM_CHAT_ID = '-1003814592979';

async function sendToTelegram() {
    const activeClass = document.querySelector('.class-item.active');
    if (!activeClass) return alert("·ûü·ûº·ûò·ûá·üí·ûö·ûæ·ûü·ûö·ûæ·ûü·ûê·üí·ûì·û∂·ûÄ·üã·ûá·û∂·ûò·ûª·ûì·ûü·û∑·ûì!");

    const className = activeClass.innerText;
    const date = document.getElementById('attDate').value;
    
    // ·ûî·üí·ûö·ûò·ûº·ûõ·ûë·û∑·ûì·üí·ûì·ûì·üê·ûô·ûü·ûö·ûª·ûî
    let presentCount = document.getElementById('cP').innerText;
    let leaveCount = document.getElementById('cL').innerText;
    let absentCount = document.getElementById('cA').innerText;
    let total = document.getElementById('cT').innerText;

    // ·ü°. ·ûö·üÄ·ûî·ûÖ·üÜ·ûÄ·üí·ûî·û∂·ûõ·û¢·ûè·üí·ûê·ûî·ûë
    let message = `üìä **·ûö·ûî·û∂·ûô·ûÄ·û∂·ûö·ûé·üç·ûü·û∑·ûü·üí·ûü·û¢·ûú·ûè·üí·ûè·ûò·û∂·ûì ·ûì·û∑·ûÑ·ûÖ·üí·ûî·û∂·ûî·üã**\n`;
    message += `üè´ ·ûê·üí·ûì·û∂·ûÄ·üã: *${className}*\n`;
    message += `üìÖ ·ûÄ·û∂·ûõ·ûî·ûö·û∑·ûÖ·üí·ûÜ·üÅ·ûë: ${date}\n`;
    message += `--------------------------\n`;
    
    let hasMissingStudents = false;
    let studentList = "";

    // ·ü¢. ·ûü·üí·ûú·üÇ·ûÑ·ûö·ûÄ·ûè·üÇ·ûü·û∑·ûü·üí·ûü·ûä·üÇ·ûõ·û¢·ûú·ûè·üí·ûè·ûò·û∂·ûì (A) ·ûì·û∑·ûÑ ·ûÖ·üí·ûî·û∂·ûî·üã (P)
    document.querySelectorAll('.student-card').forEach((card) => {
        let statusText = "";
        const isLeave = card.querySelector('.btn-att.permission').classList.contains('active');
        const isAbsent = card.querySelector('.btn-att.absent').classList.contains('active');
        
        if (isLeave) statusText = "‚úçÔ∏è ·ûÖ·üí·ûî·û∂·ûî·üã (P)";
        if (isAbsent) statusText = "‚ùå ·û¢·ûú·ûè·üí·ûè·ûò·û∂·ûì (A)";

        if (statusText !== "") {
            const name = card.getAttribute('data-name');
            const id = card.querySelector('div').innerText; // ·ûô·ûÄ ID ·ûü·û∑·ûü·üí·ûü
            studentList += `üÜî ${id}. ${name} => ${statusText}\n`;
            hasMissingStudents = true;
        }
    });

    // ·ûñ·û∑·ûì·û∑·ûè·üí·ûô·ûò·ûæ·ûõ·ûê·û∂·ûî·ûæ·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûì·û∂·ûï·üí·ûä·û∑·ûè·ûò·ûÄ·ûö·üÄ·ûì·ûë·û∂·üÜ·ûÑ·û¢·ûü·üã
    if (!hasMissingStudents) {
        message += `‚úÖ ·ûü·û∑·ûü·üí·ûü·ûò·ûÄ·ûö·üÄ·ûì·ûÇ·üí·ûö·ûî·üã·ûÖ·üÜ·ûì·ûΩ·ûì (·ûÇ·üí·ûò·û∂·ûì·ûü·û∑·ûü·üí·ûü·û¢·ûú·ûè·üí·ûè·ûò·û∂·ûì)\n`;
    } else {
        message += studentList;
    }

    // ·ü£. ·ûî·ûì·üí·ûê·üÇ·ûò·ûü·üÅ·ûÖ·ûÄ·üí·ûè·û∏·ûü·ûö·ûª·ûî·ûÅ·û∂·ûÑ·ûÄ·üí·ûö·üÑ·ûò
    message += `--------------------------\n`;
    message += `üü¢ ·ûò·ûÄ: ${presentCount} ·ûì·û∂·ûÄ·üã\n`;
    message += `üü° ·ûÖ·üí·ûî·û∂·ûî·üã (P): ${leaveCount} ·ûì·û∂·ûÄ·üã\n`;
    message += `üî¥ ·û¢·ûú·ûè·üí·ûè·ûò·û∂·ûì (A): ${absentCount} ·ûì·û∂·ûÄ·üã\n`;
    message += `üë• ·ûü·ûö·ûª·ûî: ${total} ·ûì·û∂·ûÄ·üã`;

    // ·ü§. ·ûï·üí·ûâ·ûæ·ûë·üÖ Telegram API
    const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
    
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                chat_id: TELEGRAM_CHAT_ID,
                text: message,
                parse_mode: 'Markdown'
            })
        });

        if (response.ok) {
            alert("‚úÖ ·ûî·û∂·ûì·ûï·üí·ûâ·ûæ·ûö·ûî·û∂·ûô·ûÄ·û∂·ûö·ûé·üç·ûü·û∑·ûü·üí·ûü·û¢·ûú·ûè·üí·ûè·ûò·û∂·ûì·ûë·üÖ Telegram ·ûö·ûΩ·ûÖ·ûö·û∂·ûõ·üã!");
        } else {
            alert("‚ùå ·ûî·ûö·û∂·ûá·üê·ûô! ·ûü·ûº·ûò·ûñ·û∑·ûì·û∑·ûè·üí·ûô Bot Token ·û¨ Chat ID·üî");
        }
    } catch (error) {
        alert("‚ùå ·ûò·û∂·ûì·ûî·ûâ·üí·û†·û∂·ûî·ûÖ·üí·ûÖ·üÅ·ûÄ·ûë·üÅ·ûü·ûÄ·üí·ûì·ûª·ûÑ·ûÄ·û∂·ûö·ûï·üí·ûâ·ûæ!");
    }
}
    window.onload = () => {
        const firstClass = Object.keys(studentData)[0];
        if(firstClass) renderStudents(firstClass);
    };
</script>

</body>
</html>









